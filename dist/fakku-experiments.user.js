var PRODUCTION = false;
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/attributes.ts":
/*!***************************!*\
  !*** ./src/attributes.ts ***!
  \***************************/
/*! exports provided: ATTRIBUTE, IS_MAGAZINE, Color, AttributeStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ATTRIBUTE\", function() { return ATTRIBUTE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"IS_MAGAZINE\", function() { return IS_MAGAZINE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Color\", function() { return Color; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttributeStore\", function() { return AttributeStore; });\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util */ \"./src/util.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\nvar d = document;\r\nvar w = window;\r\nvar ATTRIBUTE = /\\/(magazines|publishers|artists|tags|events|circles|series|developers)\\/([^\\/]*)$/;\r\nvar IS_MAGAZINE = /comic-bavel|comic-europa|comic-kairakuten|comic-x-eros|girls-form/;\r\nvar CATEGORY_TAG = /hentai|uncensored|book|subscription|doujin|anime|ecchi|non-h|dubbed|subbed|censored|illustration|spread|interview|western/;\r\nvar Color;\r\n(function (Color) {\r\n    Color[\"Green\"] = \"#0A9D54\";\r\n    Color[\"Turquoise\"] = \"#16a085\";\r\n    Color[\"Blue\"] = \"#2980b9\";\r\n    Color[\"Purple\"] = \"#8e44ad\";\r\n    Color[\"Black\"] = \"#2c3e50\";\r\n    Color[\"Yellow\"] = \"#f39c12\";\r\n    Color[\"Orange\"] = \"#d35400\";\r\n    Color[\"Red\"] = \"#9D0A0A\";\r\n    Color[\"White\"] = \"#bdc3c7\";\r\n    Color[\"Gray\"] = \"#7f8c8d\";\r\n    Color[\"Null\"] = \"\";\r\n})(Color || (Color = {}));\r\nfunction sortEls(a, b) {\r\n    return a[0].toLowerCase() > b[0].toLowerCase() ? 1 : -1;\r\n}\r\nfunction parseAttr(match) {\r\n    var type = match[1];\r\n    var magazine = match[2].match(IS_MAGAZINE);\r\n    var name = magazine ? magazine[0] : match[2];\r\n    return [type, name];\r\n}\r\nfunction createList(title) {\r\n    var frag = d.createDocumentFragment();\r\n    var li = d.createElement(\"li\");\r\n    li.id = \"header-\" + title.toLowerCase();\r\n    li.style.border = \"0\";\r\n    li.style.padding = \"0\";\r\n    li.innerHTML = \"<h2>\" + title + \"</h2>\";\r\n    frag.appendChild(li);\r\n    return frag;\r\n}\r\nfunction sortFrags(a, b) {\r\n    return a[0] - b[0];\r\n}\r\nvar STORE_LOCATION = \"fakku-experiments\" + \"-followed\";\r\nvar FOLLOW_PAGE = \"https://www.fakku.net/account/following\";\r\nvar SECOND = 1000;\r\nvar MINUTE = 60 * SECOND;\r\nvar HOUR = 60 * MINUTE;\r\nvar DAY = 24 * HOUR;\r\nvar WEEK = 7 * DAY;\r\nvar UPDATE_INTERVAL = WEEK;\r\nvar AttributeStore = /** @class */ (function () {\r\n    function AttributeStore() {\r\n        var _this = this;\r\n        this.store = [];\r\n        this.queuedStoreUpdate = false;\r\n        this.queuedStoreSave = false;\r\n        this.queuedPageEnhance = false;\r\n        this.queuedFollowingPageUpdate = false;\r\n        this.queuedAttributePageUpdate = false;\r\n        this.init = function () {\r\n            _this.storeLoad();\r\n            w.addEventListener(\"storage\", _this.storeLoad);\r\n            var match = location.href.match(ATTRIBUTE);\r\n            if (match) {\r\n                var _a = parseAttr(match), type = _a[0], name_1 = _a[1];\r\n                _this.attributePageInit(type, name_1);\r\n            }\r\n            else if (location.href === FOLLOW_PAGE)\r\n                _this.followingPageInit();\r\n        };\r\n        this.attributePageInit = function (type, name) {\r\n            var el = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".attribute-follow > a\");\r\n            if (el) {\r\n                var mo = new MutationObserver(_this.attributePageObserver);\r\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Monitoring attribute page follow button\");\r\n                mo.observe(el, { attributes: true });\r\n                if (el.classList.contains(\"js-unsubscribe\")) {\r\n                    if (_this.setAttr(type, name, true)) {\r\n                        _this.queuePageEnhance();\r\n                    }\r\n                }\r\n                else if (el.classList.contains(\"js-subscribe\")) {\r\n                    if (_this.setAttr(type, name, false)) {\r\n                        _this.queuePageEnhance();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.attributePageUpdate = function () {\r\n            _this.queuedAttributePageUpdate = false;\r\n            var el = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".attribute-follow > a\");\r\n            var match = location.href.match(ATTRIBUTE);\r\n            if (el && match) {\r\n                var _a = parseAttr(match), type = _a[0], name_2 = _a[1];\r\n                var attr = _this.getAttr(type, name_2);\r\n                var icon = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"i\", el);\r\n                if (attr && attr.following === true) {\r\n                    el.classList.remove(\"js-subscribe\");\r\n                    el.classList.remove(\"light\");\r\n                    el.classList.add(\"js-unsubscribe\");\r\n                    el.classList.add(\"pushed\");\r\n                    icon.classList.remove(\"bt-bell\");\r\n                    icon.classList.add(\"bt-check\");\r\n                }\r\n                else {\r\n                    el.classList.remove(\"js-unsubscribe\");\r\n                    el.classList.remove(\"pushed\");\r\n                    el.classList.add(\"js-subscribe\");\r\n                    el.classList.add(\"light\");\r\n                    icon.classList.remove(\"bt-check\");\r\n                    icon.classList.add(\"bt-bell\");\r\n                }\r\n                _this.queuePageEnhance();\r\n            }\r\n        };\r\n        this.attributePageObserver = function (ms) {\r\n            ms.forEach(function (m) {\r\n                var a = m.target;\r\n                var match = location.href.match(ATTRIBUTE);\r\n                if (match) {\r\n                    var _a = parseAttr(match), type = _a[0], name_3 = _a[1];\r\n                    if (a.classList.contains(\"js-unsubscribe\")) {\r\n                        if (_this.setAttr(type, name_3, true)) {\r\n                            _this.queuePageEnhance();\r\n                        }\r\n                    }\r\n                    else if (a.classList.contains(\"js-subscribe\")) {\r\n                        if (_this.setAttr(type, name_3, false)) {\r\n                            _this.queuePageEnhance();\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        this.followingPageInit = function () {\r\n            var lists = {\r\n                publishers: createList(\"Publishers\"),\r\n                developers: createList(\"Developers\"),\r\n                magazines: createList(\"Magazines\"),\r\n                series: createList(\"Series\"),\r\n                tags: createList(\"Tags\"),\r\n                artists: createList(\"Artists\"),\r\n                circles: createList(\"Circles\"),\r\n                events: createList(\"Events\")\r\n            };\r\n            var order = [];\r\n            var followList = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".following-list\");\r\n            if (followList) {\r\n                _this.followingPageParser(d, lists);\r\n                for (var name_4 in lists) {\r\n                    var list = lists[name_4];\r\n                    var len = list.children.length;\r\n                    if (len > 1) {\r\n                        order.push([len, list]);\r\n                    }\r\n                }\r\n                order.sort(sortFrags).forEach(function (frag) {\r\n                    followList.appendChild(frag[1]);\r\n                });\r\n                var mo = new MutationObserver(_this.followingPageObserver);\r\n                mo.observe(followList, { childList: true });\r\n            }\r\n        };\r\n        this.followingPageParser = function (doc, lists) {\r\n            var list = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".following-list\", doc);\r\n            if (list) {\r\n                var follows = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$$\"])(\"li\", list);\r\n                var followed_1 = [];\r\n                follows.forEach(function (el) {\r\n                    var a = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"a\", el);\r\n                    var match = a ? a.href.match(ATTRIBUTE) : null;\r\n                    if (match) {\r\n                        var _a = parseAttr(match), type = _a[0], name_5 = _a[1];\r\n                        followed_1.push(type + \"/\" + name_5);\r\n                        var attr = _this.getAttr(type, name_5);\r\n                        var color = attr ? attr.color : Color.Null;\r\n                        _this.setAttr(type, name_5, true, color);\r\n                        if (lists)\r\n                            lists[type].appendChild(el);\r\n                    }\r\n                    else {\r\n                        if (lists) {\r\n                            // remove headers on reruns\r\n                            list.removeChild(el);\r\n                        }\r\n                    }\r\n                });\r\n                _this.store.forEach(function (attr) {\r\n                    if (followed_1.indexOf(attr.type + \"/\" + attr.name) === -1) {\r\n                        // we do not outright remove stored attributes in order\r\n                        // to keep their color in store if later refollowed\r\n                        _this.setAttr(attr.type, attr.name, false);\r\n                    }\r\n                });\r\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Store updated\");\r\n                return true;\r\n            }\r\n            else {\r\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].error(\"Unable to parse following list\");\r\n                return false;\r\n            }\r\n        };\r\n        this.followingPageUpdate = function () {\r\n            _this.queuedFollowingPageUpdate = false;\r\n            var changes = {\r\n                removed: [],\r\n                added: [],\r\n                removedTypes: {}\r\n            };\r\n            var store = _this.store;\r\n            var followList = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".following-list\");\r\n            var entries = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$$\"])(\"li\", followList)\r\n                .filter(function (el) {\r\n                return Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"a\", el);\r\n            })\r\n                .map(function (el) {\r\n                var a = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"a\", el);\r\n                var match = a.href.match(ATTRIBUTE);\r\n                var _a = parseAttr(match), type = _a[0], name = _a[1];\r\n                var attr = _this.getAttr(type, name);\r\n                if (!attr || attr.following === false) {\r\n                    changes.removed.push([type, name]);\r\n                }\r\n                return type + \"/\" + name;\r\n            });\r\n            store.forEach(function (attr) {\r\n                var isListed = entries.indexOf(attr.type + \"/\" + attr.name) === -1;\r\n                if (attr.following === true && isListed) {\r\n                    changes.added.push([attr.type, attr.name]);\r\n                }\r\n            });\r\n            if (changes.added.length > 0) {\r\n                // if attributes added, reload\r\n                location.reload();\r\n            }\r\n            else if (changes.removed.length > 0) {\r\n                // if attributes removed, remove them from the list\r\n                changes.removed.forEach(function (attr) {\r\n                    var type = attr[0], name = attr[1];\r\n                    var el = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"a[href=\\\"/\" + type + \"/\" + name + \"\\\"]\", followList);\r\n                    changes.removedTypes[type] = true;\r\n                    if (el) {\r\n                        var li = el.parentNode;\r\n                        followList.removeChild(li);\r\n                    }\r\n                });\r\n                // remove type header if entries in attribute type hit 0 after removals\r\n                for (var type in changes.removedTypes) {\r\n                    var count = _this.getAttrTypeFollowedCount(type);\r\n                    if (count === 0) {\r\n                        var el = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"#header-\" + type, followList);\r\n                        if (el) {\r\n                            followList.removeChild(el);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        this.followingPageObserver = function (ms) {\r\n            ms.forEach(function (m) {\r\n                Array.prototype.slice.call(m.removedNodes).forEach(function (el) {\r\n                    var a = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"a\", el);\r\n                    var match = a ? a.href.match(ATTRIBUTE) : \"\";\r\n                    if (match) {\r\n                        var _a = parseAttr(match), type = _a[0], name_6 = _a[1];\r\n                        _this.setAttr(type, name_6, false);\r\n                        var count = _this.getAttrTypeFollowedCount(type);\r\n                        if (count === 0) {\r\n                            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"removing header for\", type);\r\n                            var header = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\"#header-\" + type);\r\n                            if (header) {\r\n                                var parent_1 = header.parentElement;\r\n                                if (parent_1)\r\n                                    parent_1.removeChild(header);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        this.storeSave = function () {\r\n            _this.queuedStoreSave = false;\r\n            localStorage.setItem(STORE_LOCATION, JSON.stringify({\r\n                store: _this.store,\r\n                updated: Date.now()\r\n            }));\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Saved store to localStorage\");\r\n        };\r\n        this.storeLoad = function (update) {\r\n            var stored = localStorage.getItem(STORE_LOCATION);\r\n            var storeUpdate = true;\r\n            if (stored) {\r\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Loaded store from localStorage\");\r\n                var _a = JSON.parse(stored), store = _a.store, updated = _a.updated;\r\n                var date = new Date(updated);\r\n                var now = Date.now();\r\n                _this.store = store;\r\n                if (date.getTime() >= now - UPDATE_INTERVAL)\r\n                    storeUpdate = false;\r\n            }\r\n            if (storeUpdate) {\r\n                _this.queueStoreUpdate();\r\n            }\r\n            if (update) {\r\n                if (location.href === FOLLOW_PAGE) {\r\n                    _this.queueFollowingPageUpdate();\r\n                }\r\n                else if (ATTRIBUTE.test(location.href)) {\r\n                    _this.queueAttributePageUpdate();\r\n                }\r\n            }\r\n            else {\r\n                _this.queuePageEnhance();\r\n            }\r\n        };\r\n        this.setAttr = function (type, name, following, color) {\r\n            if (color === void 0) { color = Color.Null; }\r\n            var save = true;\r\n            var attr = _this.getAttr(type, name);\r\n            if (attr) {\r\n                var followUpdate = attr.following !== following;\r\n                var colorUpdate = attr.color === Color.Null ||\r\n                    (color !== Color.Null && attr.color !== color);\r\n                if (!followUpdate && !colorUpdate) {\r\n                    // debug.log(`Attribute \"${type}/${name}\": Nothing changed:`, attr);\r\n                    save = false; // nothing changed, no need to save\r\n                }\r\n                else {\r\n                    if (attr.color === Color.Null && color === attr.color) {\r\n                        // Null is not a valid stored color\r\n                        color = Color.Green;\r\n                    }\r\n                    _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Attribute \\\"\" + type + \"/\" + name + \"\\\": \" + (followUpdate\r\n                        ? \"Changed 'following': \" + attr.following + \" -> \" + following + \" | \"\r\n                        : \"\") + \" \" + (colorUpdate ? \"Changed 'color': \" + attr.color + \" -> \" + color : \"\"));\r\n                    if (followUpdate)\r\n                        attr.following = following;\r\n                    if (colorUpdate)\r\n                        attr.color = color;\r\n                }\r\n            }\r\n            else {\r\n                color = color === Color.Null ? Color.Green : color;\r\n                _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Attribute \\\"\" + type + \"/\" + name + \"\\\": Added with 'following': \" + following + \" and 'color': \" + color);\r\n                _this.store.push({\r\n                    type: type,\r\n                    name: name,\r\n                    following: following,\r\n                    color: color\r\n                });\r\n            }\r\n            if (save)\r\n                _this.queueStoreSave();\r\n            return save;\r\n        };\r\n        this.getAttr = function (type, name) {\r\n            var store = _this.store;\r\n            for (var i = 0; i < store.length; ++i) {\r\n                var attr = store[i];\r\n                if (attr.type === type && attr.name === name) {\r\n                    return attr;\r\n                }\r\n            }\r\n        };\r\n        this.getAttrTypeFollowedCount = function (type) {\r\n            var store = _this.store;\r\n            var count = 0;\r\n            for (var i = 0; i < store.length; ++i) {\r\n                var attr = store[i];\r\n                if (attr.type === type && attr.following === true)\r\n                    ++count;\r\n            }\r\n            return count;\r\n        };\r\n        this.storeUpdate = function () { return __awaiter(_this, void 0, void 0, function () {\r\n            var res, doc, _a, success, e_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this.queuedStoreUpdate = false;\r\n                        _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Updating store via Following page fetch\");\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 4, , 5]);\r\n                        return [4 /*yield*/, fetch(FOLLOW_PAGE, { credentials: \"include\" })];\r\n                    case 2:\r\n                        res = _b.sent();\r\n                        doc = d.createElement(\"html\");\r\n                        _a = doc;\r\n                        return [4 /*yield*/, res.text()];\r\n                    case 3:\r\n                        _a.innerHTML = _b.sent();\r\n                        success = this.followingPageParser(doc);\r\n                        if (success)\r\n                            this.queuePageEnhance();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        e_1 = _b.sent();\r\n                        _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].error(e_1);\r\n                        return [3 /*break*/, 5];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        this.queueStoreSave = function () {\r\n            // debug.log(\"Queueing Store Save\");\r\n            if (!_this.queuedStoreSave) {\r\n                _this.queuedStoreSave = true;\r\n                requestAnimationFrame(_this.storeSave);\r\n            }\r\n        };\r\n        this.queueStoreUpdate = function () {\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Queuing Store Update\");\r\n            if (!_this.queuedStoreUpdate) {\r\n                _this.queuedStoreUpdate = true;\r\n                requestAnimationFrame(_this.storeUpdate);\r\n            }\r\n        };\r\n        this.queuePageEnhance = function () {\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Queuing Page Enhance\");\r\n            if (!_this.queuedPageEnhance) {\r\n                _this.queuedPageEnhance = true;\r\n                requestAnimationFrame(_this.pageEnhance);\r\n            }\r\n        };\r\n        this.queueFollowingPageUpdate = function () {\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Queuing Following Page Update\");\r\n            if (!_this.queuedFollowingPageUpdate) {\r\n                _this.queuedFollowingPageUpdate = true;\r\n                requestAnimationFrame(_this.followingPageUpdate);\r\n            }\r\n        };\r\n        this.queueAttributePageUpdate = function () {\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Queuing Attribute Page Update\");\r\n            if (!_this.queuedAttributePageUpdate) {\r\n                _this.queuedAttributePageUpdate = true;\r\n                requestAnimationFrame(_this.attributePageUpdate);\r\n            }\r\n        };\r\n        this.pageEnhance = function (update) {\r\n            _this.queuedPageEnhance = false;\r\n            _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"Enhancing page\");\r\n            var metadata = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$$\"])(\".content-meta\");\r\n            var metablock = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".content-right\");\r\n            if (metablock)\r\n                metadata.push(metablock);\r\n            metadata.forEach(function (meta) {\r\n                Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$$\"])(\".row\").forEach(function (row) {\r\n                    var rowType = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".row-left\", row).textContent || \"\";\r\n                    // skip pagecount and description fields\r\n                    if (!rowType || rowType.match(/pages|description/i))\r\n                        return;\r\n                    var attrs = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$$\"])(\".row-right > a\", row);\r\n                    // highlight followed attributes with defined colors\r\n                    attrs.forEach(function (el) {\r\n                        var a = el;\r\n                        var match = a.href.match(ATTRIBUTE);\r\n                        if (match) {\r\n                            var _a = parseAttr(match), type = _a[0], name_7 = _a[1];\r\n                            var isTag = type === \"tags\";\r\n                            var attr = _this.getAttr(type, name_7);\r\n                            if (isTag && !update) {\r\n                                var backendFollow = a.classList.contains(\"subscribed\");\r\n                                var storedFollow = attr ? attr.following : false;\r\n                                if (backendFollow !== storedFollow) {\r\n                                    // discrepancy detected between stored state and backend state,\r\n                                    // so we do a full update of store based on the following page\r\n                                    _util__WEBPACK_IMPORTED_MODULE_0__[\"debug\"].log(\"discrepancy update\", type, name_7, backendFollow);\r\n                                    _this.setAttr(type, name_7, backendFollow);\r\n                                    _this.queueStoreUpdate();\r\n                                }\r\n                            }\r\n                            if (attr && attr.following === true) {\r\n                                a.classList.add(\"subscribed\");\r\n                                if (isTag) {\r\n                                    a.style.backgroundColor = attr.color;\r\n                                    a.style.borderColor = attr.color;\r\n                                }\r\n                                else {\r\n                                    a.style.color = attr.color;\r\n                                    a.style.fontWeight = \"bold\";\r\n                                }\r\n                            }\r\n                            else {\r\n                                a.classList.remove(\"subscribed\");\r\n                                a.removeAttribute(\"style\");\r\n                            }\r\n                            // additional styles for category tags\r\n                            if (isTag && CATEGORY_TAG.test(name_7)) {\r\n                                a.style.opacity = \"0.75\";\r\n                                a.style.borderStyle = \"dashed\";\r\n                            }\r\n                        }\r\n                    });\r\n                    // sort tags into categories\r\n                    if (rowType === \"Tags\") {\r\n                        var tagList_1 = Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"$\"])(\".tags\", row);\r\n                        var followed_2 = [];\r\n                        var content_1 = [];\r\n                        var back_1 = [];\r\n                        attrs.forEach(function (el) {\r\n                            var a = el;\r\n                            var match = a.href.match(ATTRIBUTE);\r\n                            if (match) {\r\n                                var type = \"tags\";\r\n                                var name_8 = match[2];\r\n                                var isBack = CATEGORY_TAG.test(name_8);\r\n                                var attr = _this.getAttr(type, name_8);\r\n                                if (isBack) {\r\n                                    back_1.push([name_8, a]);\r\n                                }\r\n                                else if (attr && attr.following) {\r\n                                    followed_2.push([name_8, a]);\r\n                                }\r\n                                else {\r\n                                    content_1.push([name_8, a]);\r\n                                }\r\n                            }\r\n                        });\r\n                        Object(_util__WEBPACK_IMPORTED_MODULE_0__[\"cleanEl\"])(tagList_1);\r\n                        followed_2.sort(sortEls);\r\n                        content_1.sort(sortEls);\r\n                        back_1.sort(sortEls);\r\n                        followed_2\r\n                            .concat(content_1)\r\n                            .concat(back_1)\r\n                            .forEach(function (tag) {\r\n                            tagList_1.appendChild(tag[1]);\r\n                            tagList_1.appendChild(d.createTextNode(\" \"));\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        };\r\n    }\r\n    return AttributeStore;\r\n}());\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXR0cmlidXRlcy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvYXR0cmlidXRlcy50cz8yYzdhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7ICQkLCAkLCBNYXliZSwgY2xlYW5FbCwgZGVidWcsIFF1ZXJ5YWJsZSB9IGZyb20gXCIuL3V0aWxcIjtcclxuXHJcbmNvbnN0IGQgPSBkb2N1bWVudDtcclxuY29uc3QgdyA9IHdpbmRvdztcclxuZXhwb3J0IGNvbnN0IEFUVFJJQlVURSA9IC9cXC8obWFnYXppbmVzfHB1Ymxpc2hlcnN8YXJ0aXN0c3x0YWdzfGV2ZW50c3xjaXJjbGVzfHNlcmllc3xkZXZlbG9wZXJzKVxcLyhbXlxcL10qKSQvO1xyXG5leHBvcnQgY29uc3QgSVNfTUFHQVpJTkUgPSAvY29taWMtYmF2ZWx8Y29taWMtZXVyb3BhfGNvbWljLWthaXJha3V0ZW58Y29taWMteC1lcm9zfGdpcmxzLWZvcm0vO1xyXG5jb25zdCBDQVRFR09SWV9UQUcgPSAvaGVudGFpfHVuY2Vuc29yZWR8Ym9va3xzdWJzY3JpcHRpb258ZG91amlufGFuaW1lfGVjY2hpfG5vbi1ofGR1YmJlZHxzdWJiZWR8Y2Vuc29yZWR8aWxsdXN0cmF0aW9ufHNwcmVhZHxpbnRlcnZpZXd8d2VzdGVybi87XHJcblxyXG5leHBvcnQgZW51bSBDb2xvciB7XHJcbiAgR3JlZW4gPSBcIiMwQTlENTRcIixcclxuICBUdXJxdW9pc2UgPSBcIiMxNmEwODVcIixcclxuICBCbHVlID0gXCIjMjk4MGI5XCIsXHJcbiAgUHVycGxlID0gXCIjOGU0NGFkXCIsXHJcbiAgQmxhY2sgPSBcIiMyYzNlNTBcIixcclxuICBZZWxsb3cgPSBcIiNmMzljMTJcIixcclxuICBPcmFuZ2UgPSBcIiNkMzU0MDBcIixcclxuICBSZWQgPSBcIiM5RDBBMEFcIixcclxuICBXaGl0ZSA9IFwiI2JkYzNjN1wiLFxyXG4gIEdyYXkgPSBcIiM3ZjhjOGRcIixcclxuICBOdWxsID0gXCJcIlxyXG59XHJcblxyXG5pbnRlcmZhY2UgQXR0ciB7XHJcbiAgdHlwZTogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBmb2xsb3dpbmc6IGJvb2xlYW47XHJcbiAgY29sb3I6IENvbG9yO1xyXG59XHJcbnR5cGUgU3RvcmUgPSBBdHRyW107XHJcbnR5cGUgU29ydGFibGVFbCA9IFtzdHJpbmcsIEVsZW1lbnRdO1xyXG50eXBlIFNvcnRhYmxlRWxzID0gU29ydGFibGVFbFtdO1xyXG5cclxuZnVuY3Rpb24gc29ydEVscyhhOiBTb3J0YWJsZUVsLCBiOiBTb3J0YWJsZUVsKSB7XHJcbiAgcmV0dXJuIGFbMF0udG9Mb3dlckNhc2UoKSA+IGJbMF0udG9Mb3dlckNhc2UoKSA/IDEgOiAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2VBdHRyKG1hdGNoOiBSZWdFeHBNYXRjaEFycmF5KTogW3N0cmluZywgc3RyaW5nXSB7XHJcbiAgY29uc3QgdHlwZSA9IG1hdGNoWzFdO1xyXG4gIGNvbnN0IG1hZ2F6aW5lID0gbWF0Y2hbMl0ubWF0Y2goSVNfTUFHQVpJTkUpO1xyXG4gIGNvbnN0IG5hbWUgPSBtYWdhemluZSA/IG1hZ2F6aW5lWzBdIDogbWF0Y2hbMl07XHJcbiAgcmV0dXJuIFt0eXBlLCBuYW1lXTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlTGlzdCh0aXRsZTogc3RyaW5nKSB7XHJcbiAgY29uc3QgZnJhZyA9IGQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gIGNvbnN0IGxpID0gZC5jcmVhdGVFbGVtZW50KFwibGlcIik7XHJcbiAgbGkuaWQgPSBgaGVhZGVyLSR7dGl0bGUudG9Mb3dlckNhc2UoKX1gO1xyXG4gIGxpLnN0eWxlLmJvcmRlciA9IFwiMFwiO1xyXG4gIGxpLnN0eWxlLnBhZGRpbmcgPSBcIjBcIjtcclxuICBsaS5pbm5lckhUTUwgPSBgPGgyPiR7dGl0bGV9PC9oMj5gO1xyXG4gIGZyYWcuYXBwZW5kQ2hpbGQobGkpO1xyXG4gIHJldHVybiBmcmFnO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRnJhZ01hcCB7XHJcbiAgW2tleTogc3RyaW5nXTogRG9jdW1lbnRGcmFnbWVudDtcclxufVxyXG5cclxudHlwZSBTb3J0YWJsZUZyYWcgPSBbbnVtYmVyLCBEb2N1bWVudEZyYWdtZW50XTtcclxudHlwZSBTb3J0YWJsZUZyYWdzID0gU29ydGFibGVGcmFnW107XHJcblxyXG5mdW5jdGlvbiBzb3J0RnJhZ3MoYTogU29ydGFibGVGcmFnLCBiOiBTb3J0YWJsZUZyYWcpIHtcclxuICByZXR1cm4gYVswXSAtIGJbMF07XHJcbn1cclxuXHJcbmNvbnN0IFNUT1JFX0xPQ0FUSU9OID0gYCR7U1RPUkVfS0VZfS1mb2xsb3dlZGA7XHJcblxyXG5jb25zdCBGT0xMT1dfUEFHRSA9IFwiaHR0cHM6Ly93d3cuZmFra3UubmV0L2FjY291bnQvZm9sbG93aW5nXCI7XHJcbmNvbnN0IFNFQ09ORCA9IDEwMDA7XHJcbmNvbnN0IE1JTlVURSA9IDYwICogU0VDT05EO1xyXG5jb25zdCBIT1VSID0gNjAgKiBNSU5VVEU7XHJcbmNvbnN0IERBWSA9IDI0ICogSE9VUjtcclxuY29uc3QgV0VFSyA9IDcgKiBEQVk7XHJcbmNvbnN0IFVQREFURV9JTlRFUlZBTCA9IFdFRUs7XHJcblxyXG5leHBvcnQgY2xhc3MgQXR0cmlidXRlU3RvcmUge1xyXG4gIHN0b3JlOiBBdHRyW10gPSBbXTtcclxuICBxdWV1ZWRTdG9yZVVwZGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHF1ZXVlZFN0b3JlU2F2ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHF1ZXVlZFBhZ2VFbmhhbmNlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcXVldWVkRm9sbG93aW5nUGFnZVVwZGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHF1ZXVlZEF0dHJpYnV0ZVBhZ2VVcGRhdGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgaW5pdCA9ICgpID0+IHtcclxuICAgIHRoaXMuc3RvcmVMb2FkKCk7XHJcbiAgICB3LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuc3RvcmVMb2FkKTtcclxuICAgIGNvbnN0IG1hdGNoID0gbG9jYXRpb24uaHJlZi5tYXRjaChBVFRSSUJVVEUpO1xyXG4gICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgIGNvbnN0IFt0eXBlLCBuYW1lXSA9IHBhcnNlQXR0cihtYXRjaCk7XHJcbiAgICAgIHRoaXMuYXR0cmlidXRlUGFnZUluaXQodHlwZSwgbmFtZSk7XHJcbiAgICB9IGVsc2UgaWYgKGxvY2F0aW9uLmhyZWYgPT09IEZPTExPV19QQUdFKSB0aGlzLmZvbGxvd2luZ1BhZ2VJbml0KCk7XHJcbiAgfTtcclxuXHJcbiAgYXR0cmlidXRlUGFnZUluaXQgPSAodHlwZTogc3RyaW5nLCBuYW1lOiBzdHJpbmcpID0+IHtcclxuICAgIGNvbnN0IGVsID0gJChcIi5hdHRyaWJ1dGUtZm9sbG93ID4gYVwiKTtcclxuICAgIGlmIChlbCkge1xyXG4gICAgICBjb25zdCBtbyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuYXR0cmlidXRlUGFnZU9ic2VydmVyKTtcclxuICAgICAgZGVidWcubG9nKFwiTW9uaXRvcmluZyBhdHRyaWJ1dGUgcGFnZSBmb2xsb3cgYnV0dG9uXCIpO1xyXG4gICAgICBtby5vYnNlcnZlKGVsLCB7IGF0dHJpYnV0ZXM6IHRydWUgfSk7XHJcbiAgICAgIGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJqcy11bnN1YnNjcmliZVwiKSkge1xyXG4gICAgICAgIGlmICh0aGlzLnNldEF0dHIodHlwZSwgbmFtZSwgdHJ1ZSkpIHtcclxuICAgICAgICAgIHRoaXMucXVldWVQYWdlRW5oYW5jZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJqcy1zdWJzY3JpYmVcIikpIHtcclxuICAgICAgICBpZiAodGhpcy5zZXRBdHRyKHR5cGUsIG5hbWUsIGZhbHNlKSkge1xyXG4gICAgICAgICAgdGhpcy5xdWV1ZVBhZ2VFbmhhbmNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgYXR0cmlidXRlUGFnZVVwZGF0ZSA9ICgpID0+IHtcclxuICAgIHRoaXMucXVldWVkQXR0cmlidXRlUGFnZVVwZGF0ZSA9IGZhbHNlO1xyXG4gICAgY29uc3QgZWwgPSAkKFwiLmF0dHJpYnV0ZS1mb2xsb3cgPiBhXCIpO1xyXG4gICAgY29uc3QgbWF0Y2ggPSBsb2NhdGlvbi5ocmVmLm1hdGNoKEFUVFJJQlVURSk7XHJcbiAgICBpZiAoZWwgJiYgbWF0Y2gpIHtcclxuICAgICAgY29uc3QgW3R5cGUsIG5hbWVdID0gcGFyc2VBdHRyKG1hdGNoKTtcclxuICAgICAgY29uc3QgYXR0ciA9IHRoaXMuZ2V0QXR0cih0eXBlLCBuYW1lKTtcclxuICAgICAgY29uc3QgaWNvbiA9ICQoXCJpXCIsIGVsKSE7XHJcbiAgICAgIGlmIChhdHRyICYmIGF0dHIuZm9sbG93aW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcImpzLXN1YnNjcmliZVwiKTtcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwibGlnaHRcIik7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImpzLXVuc3Vic2NyaWJlXCIpO1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJwdXNoZWRcIik7XHJcbiAgICAgICAgaWNvbi5jbGFzc0xpc3QucmVtb3ZlKFwiYnQtYmVsbFwiKTtcclxuICAgICAgICBpY29uLmNsYXNzTGlzdC5hZGQoXCJidC1jaGVja1wiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwianMtdW5zdWJzY3JpYmVcIik7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcInB1c2hlZFwiKTtcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKFwianMtc3Vic2NyaWJlXCIpO1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJsaWdodFwiKTtcclxuICAgICAgICBpY29uLmNsYXNzTGlzdC5yZW1vdmUoXCJidC1jaGVja1wiKTtcclxuICAgICAgICBpY29uLmNsYXNzTGlzdC5hZGQoXCJidC1iZWxsXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucXVldWVQYWdlRW5oYW5jZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGF0dHJpYnV0ZVBhZ2VPYnNlcnZlciA9IChtczogTXV0YXRpb25SZWNvcmRbXSkgPT4ge1xyXG4gICAgbXMuZm9yRWFjaChtID0+IHtcclxuICAgICAgY29uc3QgYSA9IG0udGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50O1xyXG4gICAgICBjb25zdCBtYXRjaCA9IGxvY2F0aW9uLmhyZWYubWF0Y2goQVRUUklCVVRFKTtcclxuICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgW3R5cGUsIG5hbWVdID0gcGFyc2VBdHRyKG1hdGNoKTtcclxuICAgICAgICBpZiAoYS5jbGFzc0xpc3QuY29udGFpbnMoXCJqcy11bnN1YnNjcmliZVwiKSkge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0QXR0cih0eXBlLCBuYW1lLCB0cnVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlUGFnZUVuaGFuY2UoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGEuY2xhc3NMaXN0LmNvbnRhaW5zKFwianMtc3Vic2NyaWJlXCIpKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zZXRBdHRyKHR5cGUsIG5hbWUsIGZhbHNlKSkge1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlUGFnZUVuaGFuY2UoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGZvbGxvd2luZ1BhZ2VJbml0ID0gKCkgPT4ge1xyXG4gICAgY29uc3QgbGlzdHM6IEZyYWdNYXAgPSB7XHJcbiAgICAgIHB1Ymxpc2hlcnM6IGNyZWF0ZUxpc3QoXCJQdWJsaXNoZXJzXCIpLFxyXG4gICAgICBkZXZlbG9wZXJzOiBjcmVhdGVMaXN0KFwiRGV2ZWxvcGVyc1wiKSxcclxuICAgICAgbWFnYXppbmVzOiBjcmVhdGVMaXN0KFwiTWFnYXppbmVzXCIpLFxyXG4gICAgICBzZXJpZXM6IGNyZWF0ZUxpc3QoXCJTZXJpZXNcIiksXHJcbiAgICAgIHRhZ3M6IGNyZWF0ZUxpc3QoXCJUYWdzXCIpLFxyXG4gICAgICBhcnRpc3RzOiBjcmVhdGVMaXN0KFwiQXJ0aXN0c1wiKSxcclxuICAgICAgY2lyY2xlczogY3JlYXRlTGlzdChcIkNpcmNsZXNcIiksXHJcbiAgICAgIGV2ZW50czogY3JlYXRlTGlzdChcIkV2ZW50c1wiKVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBvcmRlcjogU29ydGFibGVGcmFncyA9IFtdO1xyXG5cclxuICAgIGNvbnN0IGZvbGxvd0xpc3QgPSAkKFwiLmZvbGxvd2luZy1saXN0XCIpO1xyXG4gICAgaWYgKGZvbGxvd0xpc3QpIHtcclxuICAgICAgdGhpcy5mb2xsb3dpbmdQYWdlUGFyc2VyKGQsIGxpc3RzKTtcclxuICAgICAgZm9yIChsZXQgbmFtZSBpbiBsaXN0cykge1xyXG4gICAgICAgIGNvbnN0IGxpc3QgPSBsaXN0c1tuYW1lXTtcclxuICAgICAgICBjb25zdCBsZW4gPSBsaXN0LmNoaWxkcmVuLmxlbmd0aDtcclxuICAgICAgICBpZiAobGVuID4gMSkge1xyXG4gICAgICAgICAgb3JkZXIucHVzaChbbGVuLCBsaXN0XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIG9yZGVyLnNvcnQoc29ydEZyYWdzKS5mb3JFYWNoKGZyYWcgPT4ge1xyXG4gICAgICAgIGZvbGxvd0xpc3QuYXBwZW5kQ2hpbGQoZnJhZ1sxXSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCBtbyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuZm9sbG93aW5nUGFnZU9ic2VydmVyKTtcclxuICAgICAgbW8ub2JzZXJ2ZShmb2xsb3dMaXN0LCB7IGNoaWxkTGlzdDogdHJ1ZSB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBmb2xsb3dpbmdQYWdlUGFyc2VyID0gKGRvYzogUXVlcnlhYmxlLCBsaXN0cz86IEZyYWdNYXApID0+IHtcclxuICAgIGNvbnN0IGxpc3QgPSAkKFwiLmZvbGxvd2luZy1saXN0XCIsIGRvYyk7XHJcbiAgICBpZiAobGlzdCkge1xyXG4gICAgICBjb25zdCBmb2xsb3dzID0gJCQoXCJsaVwiLCBsaXN0KTtcclxuICAgICAgY29uc3QgZm9sbG93ZWQ6IHN0cmluZ1tdID0gW107XHJcbiAgICAgIGZvbGxvd3MuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgY29uc3QgYSA9ICQoXCJhXCIsIGVsKTtcclxuICAgICAgICBjb25zdCBtYXRjaCA9IGEgPyAoYSBhcyBIVE1MQW5jaG9yRWxlbWVudCkuaHJlZi5tYXRjaChBVFRSSUJVVEUpIDogbnVsbDtcclxuICAgICAgICBpZiAobWF0Y2gpIHtcclxuICAgICAgICAgIGNvbnN0IFt0eXBlLCBuYW1lXSA9IHBhcnNlQXR0cihtYXRjaCk7XHJcbiAgICAgICAgICBmb2xsb3dlZC5wdXNoKGAke3R5cGV9LyR7bmFtZX1gKTtcclxuICAgICAgICAgIGNvbnN0IGF0dHIgPSB0aGlzLmdldEF0dHIodHlwZSwgbmFtZSk7XHJcbiAgICAgICAgICBjb25zdCBjb2xvciA9IGF0dHIgPyBhdHRyLmNvbG9yIDogQ29sb3IuTnVsbDtcclxuICAgICAgICAgIHRoaXMuc2V0QXR0cih0eXBlLCBuYW1lLCB0cnVlLCBjb2xvcik7XHJcbiAgICAgICAgICBpZiAobGlzdHMpIGxpc3RzW3R5cGVdLmFwcGVuZENoaWxkKGVsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGxpc3RzKSB7XHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSBoZWFkZXJzIG9uIHJlcnVuc1xyXG4gICAgICAgICAgICBsaXN0LnJlbW92ZUNoaWxkKGVsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLnN0b3JlLmZvckVhY2goYXR0ciA9PiB7XHJcbiAgICAgICAgaWYgKGZvbGxvd2VkLmluZGV4T2YoYCR7YXR0ci50eXBlfS8ke2F0dHIubmFtZX1gKSA9PT0gLTEpIHtcclxuICAgICAgICAgIC8vIHdlIGRvIG5vdCBvdXRyaWdodCByZW1vdmUgc3RvcmVkIGF0dHJpYnV0ZXMgaW4gb3JkZXJcclxuICAgICAgICAgIC8vIHRvIGtlZXAgdGhlaXIgY29sb3IgaW4gc3RvcmUgaWYgbGF0ZXIgcmVmb2xsb3dlZFxyXG4gICAgICAgICAgdGhpcy5zZXRBdHRyKGF0dHIudHlwZSwgYXR0ci5uYW1lLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgZGVidWcubG9nKFwiU3RvcmUgdXBkYXRlZFwiKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZWJ1Zy5lcnJvcihcIlVuYWJsZSB0byBwYXJzZSBmb2xsb3dpbmcgbGlzdFwiKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGZvbGxvd2luZ1BhZ2VVcGRhdGUgPSAoKSA9PiB7XHJcbiAgICB0aGlzLnF1ZXVlZEZvbGxvd2luZ1BhZ2VVcGRhdGUgPSBmYWxzZTtcclxuICAgIGNvbnN0IGNoYW5nZXMgPSB7XHJcbiAgICAgIHJlbW92ZWQ6IFtdIGFzIFtzdHJpbmcsIHN0cmluZ11bXSxcclxuICAgICAgYWRkZWQ6IFtdIGFzIFtzdHJpbmcsIHN0cmluZ11bXSxcclxuICAgICAgcmVtb3ZlZFR5cGVzOiB7fSBhcyB7IFtrZXk6IHN0cmluZ106IHRydWUgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBzdG9yZSA9IHRoaXMuc3RvcmU7XHJcbiAgICBjb25zdCBmb2xsb3dMaXN0ID0gJChcIi5mb2xsb3dpbmctbGlzdFwiKSE7XHJcbiAgICBjb25zdCBlbnRyaWVzOiBzdHJpbmdbXSA9ICQkKFwibGlcIiwgZm9sbG93TGlzdClcclxuICAgICAgLmZpbHRlcihlbCA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQoXCJhXCIsIGVsKTtcclxuICAgICAgfSlcclxuICAgICAgLm1hcChlbCA9PiB7XHJcbiAgICAgICAgY29uc3QgYSA9ICQoXCJhXCIsIGVsKSEgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBhLmhyZWYubWF0Y2goQVRUUklCVVRFKSE7XHJcbiAgICAgICAgY29uc3QgW3R5cGUsIG5hbWVdID0gcGFyc2VBdHRyKG1hdGNoKTtcclxuICAgICAgICBjb25zdCBhdHRyID0gdGhpcy5nZXRBdHRyKHR5cGUsIG5hbWUpO1xyXG4gICAgICAgIGlmICghYXR0ciB8fCBhdHRyLmZvbGxvd2luZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIGNoYW5nZXMucmVtb3ZlZC5wdXNoKFt0eXBlLCBuYW1lXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlICsgXCIvXCIgKyBuYW1lO1xyXG4gICAgICB9KTtcclxuICAgIHN0b3JlLmZvckVhY2goYXR0ciA9PiB7XHJcbiAgICAgIGNvbnN0IGlzTGlzdGVkID0gZW50cmllcy5pbmRleE9mKGAke2F0dHIudHlwZX0vJHthdHRyLm5hbWV9YCkgPT09IC0xO1xyXG4gICAgICBpZiAoYXR0ci5mb2xsb3dpbmcgPT09IHRydWUgJiYgaXNMaXN0ZWQpIHtcclxuICAgICAgICBjaGFuZ2VzLmFkZGVkLnB1c2goW2F0dHIudHlwZSwgYXR0ci5uYW1lXSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChjaGFuZ2VzLmFkZGVkLmxlbmd0aCA+IDApIHtcclxuICAgICAgLy8gaWYgYXR0cmlidXRlcyBhZGRlZCwgcmVsb2FkXHJcbiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzLnJlbW92ZWQubGVuZ3RoID4gMCkge1xyXG4gICAgICAvLyBpZiBhdHRyaWJ1dGVzIHJlbW92ZWQsIHJlbW92ZSB0aGVtIGZyb20gdGhlIGxpc3RcclxuICAgICAgY2hhbmdlcy5yZW1vdmVkLmZvckVhY2goYXR0ciA9PiB7XHJcbiAgICAgICAgY29uc3QgW3R5cGUsIG5hbWVdID0gYXR0cjtcclxuICAgICAgICBjb25zdCBlbCA9ICQoYGFbaHJlZj1cIi8ke3R5cGV9LyR7bmFtZX1cIl1gLCBmb2xsb3dMaXN0KTtcclxuICAgICAgICBjaGFuZ2VzLnJlbW92ZWRUeXBlc1t0eXBlXSA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVsKSB7XHJcbiAgICAgICAgICBjb25zdCBsaSA9IGVsLnBhcmVudE5vZGUhO1xyXG4gICAgICAgICAgZm9sbG93TGlzdC5yZW1vdmVDaGlsZChsaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIHJlbW92ZSB0eXBlIGhlYWRlciBpZiBlbnRyaWVzIGluIGF0dHJpYnV0ZSB0eXBlIGhpdCAwIGFmdGVyIHJlbW92YWxzXHJcbiAgICAgIGZvciAobGV0IHR5cGUgaW4gY2hhbmdlcy5yZW1vdmVkVHlwZXMpIHtcclxuICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuZ2V0QXR0clR5cGVGb2xsb3dlZENvdW50KHR5cGUpO1xyXG4gICAgICAgIGlmIChjb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgY29uc3QgZWwgPSAkKGAjaGVhZGVyLSR7dHlwZX1gLCBmb2xsb3dMaXN0KTtcclxuICAgICAgICAgIGlmIChlbCkge1xyXG4gICAgICAgICAgICBmb2xsb3dMaXN0LnJlbW92ZUNoaWxkKGVsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG5cclxuICBmb2xsb3dpbmdQYWdlT2JzZXJ2ZXIgPSAobXM6IE11dGF0aW9uUmVjb3JkW10pID0+IHtcclxuICAgIG1zLmZvckVhY2gobSA9PiB7XHJcbiAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKG0ucmVtb3ZlZE5vZGVzKS5mb3JFYWNoKChlbDogRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGEgPSAkKFwiYVwiLCBlbCkgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBhID8gYS5ocmVmLm1hdGNoKEFUVFJJQlVURSkgOiBcIlwiO1xyXG4gICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgY29uc3QgW3R5cGUsIG5hbWVdID0gcGFyc2VBdHRyKG1hdGNoKTtcclxuICAgICAgICAgIHRoaXMuc2V0QXR0cih0eXBlLCBuYW1lLCBmYWxzZSk7XHJcbiAgICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuZ2V0QXR0clR5cGVGb2xsb3dlZENvdW50KHR5cGUpO1xyXG4gICAgICAgICAgaWYgKGNvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgIGRlYnVnLmxvZyhcInJlbW92aW5nIGhlYWRlciBmb3JcIiwgdHlwZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9ICQoYCNoZWFkZXItJHt0eXBlfWApO1xyXG4gICAgICAgICAgICBpZiAoaGVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gaGVhZGVyLnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgaWYgKHBhcmVudCkgcGFyZW50LnJlbW92ZUNoaWxkKGhlYWRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgc3RvcmVTYXZlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5xdWV1ZWRTdG9yZVNhdmUgPSBmYWxzZTtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFxyXG4gICAgICBTVE9SRV9MT0NBVElPTixcclxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIHN0b3JlOiB0aGlzLnN0b3JlLFxyXG4gICAgICAgIHVwZGF0ZWQ6IERhdGUubm93KClcclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgICBkZWJ1Zy5sb2coXCJTYXZlZCBzdG9yZSB0byBsb2NhbFN0b3JhZ2VcIik7XHJcbiAgfTtcclxuXHJcbiAgc3RvcmVMb2FkID0gKHVwZGF0ZT86IG51bWJlciB8IEV2ZW50KSA9PiB7XHJcbiAgICBjb25zdCBzdG9yZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShTVE9SRV9MT0NBVElPTik7XHJcbiAgICBsZXQgc3RvcmVVcGRhdGUgPSB0cnVlO1xyXG4gICAgaWYgKHN0b3JlZCkge1xyXG4gICAgICBkZWJ1Zy5sb2coXCJMb2FkZWQgc3RvcmUgZnJvbSBsb2NhbFN0b3JhZ2VcIik7XHJcbiAgICAgIGNvbnN0IHsgc3RvcmUsIHVwZGF0ZWQgfSA9IEpTT04ucGFyc2Uoc3RvcmVkKTtcclxuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHVwZGF0ZWQpO1xyXG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICB0aGlzLnN0b3JlID0gc3RvcmU7XHJcbiAgICAgIGlmIChkYXRlLmdldFRpbWUoKSA+PSBub3cgLSBVUERBVEVfSU5URVJWQUwpIHN0b3JlVXBkYXRlID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAoc3RvcmVVcGRhdGUpIHtcclxuICAgICAgdGhpcy5xdWV1ZVN0b3JlVXBkYXRlKCk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlKSB7XHJcbiAgICAgIGlmIChsb2NhdGlvbi5ocmVmID09PSBGT0xMT1dfUEFHRSkge1xyXG4gICAgICAgIHRoaXMucXVldWVGb2xsb3dpbmdQYWdlVXBkYXRlKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoQVRUUklCVVRFLnRlc3QobG9jYXRpb24uaHJlZikpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlQXR0cmlidXRlUGFnZVVwZGF0ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnF1ZXVlUGFnZUVuaGFuY2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRBdHRyID0gKFxyXG4gICAgdHlwZTogc3RyaW5nLFxyXG4gICAgbmFtZTogc3RyaW5nLFxyXG4gICAgZm9sbG93aW5nOiBib29sZWFuLFxyXG4gICAgY29sb3IgPSBDb2xvci5OdWxsXHJcbiAgKTogYm9vbGVhbiA9PiB7XHJcbiAgICBsZXQgc2F2ZSA9IHRydWU7XHJcbiAgICBjb25zdCBhdHRyID0gdGhpcy5nZXRBdHRyKHR5cGUsIG5hbWUpO1xyXG4gICAgaWYgKGF0dHIpIHtcclxuICAgICAgY29uc3QgZm9sbG93VXBkYXRlID0gYXR0ci5mb2xsb3dpbmcgIT09IGZvbGxvd2luZztcclxuICAgICAgY29uc3QgY29sb3JVcGRhdGUgPVxyXG4gICAgICAgIGF0dHIuY29sb3IgPT09IENvbG9yLk51bGwgfHxcclxuICAgICAgICAoY29sb3IgIT09IENvbG9yLk51bGwgJiYgYXR0ci5jb2xvciAhPT0gY29sb3IpO1xyXG4gICAgICBpZiAoIWZvbGxvd1VwZGF0ZSAmJiAhY29sb3JVcGRhdGUpIHtcclxuICAgICAgICAvLyBkZWJ1Zy5sb2coYEF0dHJpYnV0ZSBcIiR7dHlwZX0vJHtuYW1lfVwiOiBOb3RoaW5nIGNoYW5nZWQ6YCwgYXR0cik7XHJcbiAgICAgICAgc2F2ZSA9IGZhbHNlOyAvLyBub3RoaW5nIGNoYW5nZWQsIG5vIG5lZWQgdG8gc2F2ZVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChhdHRyLmNvbG9yID09PSBDb2xvci5OdWxsICYmIGNvbG9yID09PSBhdHRyLmNvbG9yKSB7XHJcbiAgICAgICAgICAvLyBOdWxsIGlzIG5vdCBhIHZhbGlkIHN0b3JlZCBjb2xvclxyXG4gICAgICAgICAgY29sb3IgPSBDb2xvci5HcmVlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVidWcubG9nKFxyXG4gICAgICAgICAgYEF0dHJpYnV0ZSBcIiR7dHlwZX0vJHtuYW1lfVwiOiAke1xyXG4gICAgICAgICAgICBmb2xsb3dVcGRhdGVcclxuICAgICAgICAgICAgICA/IGBDaGFuZ2VkICdmb2xsb3dpbmcnOiAke2F0dHIuZm9sbG93aW5nfSAtPiAke2ZvbGxvd2luZ30gfCBgXHJcbiAgICAgICAgICAgICAgOiBcIlwiXHJcbiAgICAgICAgICB9ICR7Y29sb3JVcGRhdGUgPyBgQ2hhbmdlZCAnY29sb3InOiAke2F0dHIuY29sb3J9IC0+ICR7Y29sb3J9YCA6IFwiXCJ9YFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKGZvbGxvd1VwZGF0ZSkgYXR0ci5mb2xsb3dpbmcgPSBmb2xsb3dpbmc7XHJcbiAgICAgICAgaWYgKGNvbG9yVXBkYXRlKSBhdHRyLmNvbG9yID0gY29sb3I7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbG9yID0gY29sb3IgPT09IENvbG9yLk51bGwgPyBDb2xvci5HcmVlbiA6IGNvbG9yO1xyXG4gICAgICBkZWJ1Zy5sb2coXHJcbiAgICAgICAgYEF0dHJpYnV0ZSBcIiR7dHlwZX0vJHtuYW1lfVwiOiBBZGRlZCB3aXRoICdmb2xsb3dpbmcnOiAke2ZvbGxvd2luZ30gYW5kICdjb2xvcic6ICR7Y29sb3J9YFxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLnN0b3JlLnB1c2goe1xyXG4gICAgICAgIHR5cGUsXHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBmb2xsb3dpbmcsXHJcbiAgICAgICAgY29sb3JcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoc2F2ZSkgdGhpcy5xdWV1ZVN0b3JlU2F2ZSgpO1xyXG4gICAgcmV0dXJuIHNhdmU7XHJcbiAgfTtcclxuXHJcbiAgZ2V0QXR0ciA9ICh0eXBlOiBzdHJpbmcsIG5hbWU6IHN0cmluZyk6IE1heWJlPEF0dHI+ID0+IHtcclxuICAgIGNvbnN0IHN0b3JlID0gdGhpcy5zdG9yZTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RvcmUubGVuZ3RoOyArK2kpIHtcclxuICAgICAgY29uc3QgYXR0ciA9IHN0b3JlW2ldO1xyXG4gICAgICBpZiAoYXR0ci50eXBlID09PSB0eXBlICYmIGF0dHIubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgIHJldHVybiBhdHRyO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgZ2V0QXR0clR5cGVGb2xsb3dlZENvdW50ID0gKHR5cGU6IHN0cmluZyk6IG51bWJlciA9PiB7XHJcbiAgICBjb25zdCBzdG9yZSA9IHRoaXMuc3RvcmU7XHJcbiAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdG9yZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICBjb25zdCBhdHRyID0gc3RvcmVbaV07XHJcbiAgICAgIGlmIChhdHRyLnR5cGUgPT09IHR5cGUgJiYgYXR0ci5mb2xsb3dpbmcgPT09IHRydWUpICsrY291bnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY291bnQ7XHJcbiAgfTtcclxuXHJcbiAgc3RvcmVVcGRhdGUgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0aGlzLnF1ZXVlZFN0b3JlVXBkYXRlID0gZmFsc2U7XHJcbiAgICBkZWJ1Zy5sb2coXCJVcGRhdGluZyBzdG9yZSB2aWEgRm9sbG93aW5nIHBhZ2UgZmV0Y2hcIik7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChGT0xMT1dfUEFHRSwgeyBjcmVkZW50aWFsczogXCJpbmNsdWRlXCIgfSk7XHJcbiAgICAgIGNvbnN0IGRvYyA9IGQuY3JlYXRlRWxlbWVudChcImh0bWxcIik7XHJcbiAgICAgIGRvYy5pbm5lckhUTUwgPSBhd2FpdCByZXMudGV4dCgpO1xyXG4gICAgICBjb25zdCBzdWNjZXNzID0gdGhpcy5mb2xsb3dpbmdQYWdlUGFyc2VyKGRvYyk7XHJcbiAgICAgIGlmIChzdWNjZXNzKSB0aGlzLnF1ZXVlUGFnZUVuaGFuY2UoKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgZGVidWcuZXJyb3IoZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcXVldWVTdG9yZVNhdmUgPSAoKSA9PiB7XHJcbiAgICAvLyBkZWJ1Zy5sb2coXCJRdWV1ZWluZyBTdG9yZSBTYXZlXCIpO1xyXG4gICAgaWYgKCF0aGlzLnF1ZXVlZFN0b3JlU2F2ZSkge1xyXG4gICAgICB0aGlzLnF1ZXVlZFN0b3JlU2F2ZSA9IHRydWU7XHJcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnN0b3JlU2F2ZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcXVldWVTdG9yZVVwZGF0ZSA9ICgpID0+IHtcclxuICAgIGRlYnVnLmxvZyhcIlF1ZXVpbmcgU3RvcmUgVXBkYXRlXCIpO1xyXG4gICAgaWYgKCF0aGlzLnF1ZXVlZFN0b3JlVXBkYXRlKSB7XHJcbiAgICAgIHRoaXMucXVldWVkU3RvcmVVcGRhdGUgPSB0cnVlO1xyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5zdG9yZVVwZGF0ZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcXVldWVQYWdlRW5oYW5jZSA9ICgpID0+IHtcclxuICAgIGRlYnVnLmxvZyhcIlF1ZXVpbmcgUGFnZSBFbmhhbmNlXCIpO1xyXG4gICAgaWYgKCF0aGlzLnF1ZXVlZFBhZ2VFbmhhbmNlKSB7XHJcbiAgICAgIHRoaXMucXVldWVkUGFnZUVuaGFuY2UgPSB0cnVlO1xyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5wYWdlRW5oYW5jZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcXVldWVGb2xsb3dpbmdQYWdlVXBkYXRlID0gKCkgPT4ge1xyXG4gICAgZGVidWcubG9nKFwiUXVldWluZyBGb2xsb3dpbmcgUGFnZSBVcGRhdGVcIik7XHJcbiAgICBpZiAoIXRoaXMucXVldWVkRm9sbG93aW5nUGFnZVVwZGF0ZSkge1xyXG4gICAgICB0aGlzLnF1ZXVlZEZvbGxvd2luZ1BhZ2VVcGRhdGUgPSB0cnVlO1xyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5mb2xsb3dpbmdQYWdlVXBkYXRlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBxdWV1ZUF0dHJpYnV0ZVBhZ2VVcGRhdGUgPSAoKSA9PiB7XHJcbiAgICBkZWJ1Zy5sb2coXCJRdWV1aW5nIEF0dHJpYnV0ZSBQYWdlIFVwZGF0ZVwiKTtcclxuICAgIGlmICghdGhpcy5xdWV1ZWRBdHRyaWJ1dGVQYWdlVXBkYXRlKSB7XHJcbiAgICAgIHRoaXMucXVldWVkQXR0cmlidXRlUGFnZVVwZGF0ZSA9IHRydWU7XHJcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmF0dHJpYnV0ZVBhZ2VVcGRhdGUpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHBhZ2VFbmhhbmNlID0gKHVwZGF0ZT86IG51bWJlcikgPT4ge1xyXG4gICAgdGhpcy5xdWV1ZWRQYWdlRW5oYW5jZSA9IGZhbHNlO1xyXG4gICAgZGVidWcubG9nKFwiRW5oYW5jaW5nIHBhZ2VcIik7XHJcbiAgICBjb25zdCBtZXRhZGF0YSA9ICQkKFwiLmNvbnRlbnQtbWV0YVwiKTtcclxuICAgIGNvbnN0IG1ldGFibG9jayA9ICQoXCIuY29udGVudC1yaWdodFwiKTtcclxuICAgIGlmIChtZXRhYmxvY2spIG1ldGFkYXRhLnB1c2gobWV0YWJsb2NrKTtcclxuXHJcbiAgICBtZXRhZGF0YS5mb3JFYWNoKChtZXRhOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICQkKFwiLnJvd1wiKS5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgICAgY29uc3Qgcm93VHlwZSA9ICQoXCIucm93LWxlZnRcIiwgcm93KSEudGV4dENvbnRlbnQgfHwgXCJcIjtcclxuICAgICAgICAvLyBza2lwIHBhZ2Vjb3VudCBhbmQgZGVzY3JpcHRpb24gZmllbGRzXHJcbiAgICAgICAgaWYgKCFyb3dUeXBlIHx8IHJvd1R5cGUubWF0Y2goL3BhZ2VzfGRlc2NyaXB0aW9uL2kpKSByZXR1cm47XHJcbiAgICAgICAgY29uc3QgYXR0cnMgPSAkJChcIi5yb3ctcmlnaHQgPiBhXCIsIHJvdyk7XHJcbiAgICAgICAgLy8gaGlnaGxpZ2h0IGZvbGxvd2VkIGF0dHJpYnV0ZXMgd2l0aCBkZWZpbmVkIGNvbG9yc1xyXG4gICAgICAgIGF0dHJzLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgICAgY29uc3QgYSA9IGVsIGFzIEhUTUxBbmNob3JFbGVtZW50O1xyXG4gICAgICAgICAgY29uc3QgbWF0Y2ggPSBhLmhyZWYubWF0Y2goQVRUUklCVVRFKTtcclxuICAgICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgICBjb25zdCBbdHlwZSwgbmFtZV0gPSBwYXJzZUF0dHIobWF0Y2gpO1xyXG4gICAgICAgICAgICBjb25zdCBpc1RhZyA9IHR5cGUgPT09IFwidGFnc1wiO1xyXG4gICAgICAgICAgICBjb25zdCBhdHRyID0gdGhpcy5nZXRBdHRyKHR5cGUsIG5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoaXNUYWcgJiYgIXVwZGF0ZSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGJhY2tlbmRGb2xsb3cgPSBhLmNsYXNzTGlzdC5jb250YWlucyhcInN1YnNjcmliZWRcIik7XHJcbiAgICAgICAgICAgICAgY29uc3Qgc3RvcmVkRm9sbG93ID0gYXR0ciA/IGF0dHIuZm9sbG93aW5nIDogZmFsc2U7XHJcbiAgICAgICAgICAgICAgaWYgKGJhY2tlbmRGb2xsb3cgIT09IHN0b3JlZEZvbGxvdykge1xyXG4gICAgICAgICAgICAgICAgLy8gZGlzY3JlcGFuY3kgZGV0ZWN0ZWQgYmV0d2VlbiBzdG9yZWQgc3RhdGUgYW5kIGJhY2tlbmQgc3RhdGUsXHJcbiAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkbyBhIGZ1bGwgdXBkYXRlIG9mIHN0b3JlIGJhc2VkIG9uIHRoZSBmb2xsb3dpbmcgcGFnZVxyXG4gICAgICAgICAgICAgICAgZGVidWcubG9nKFwiZGlzY3JlcGFuY3kgdXBkYXRlXCIsIHR5cGUsIG5hbWUsIGJhY2tlbmRGb2xsb3cpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyKHR5cGUsIG5hbWUsIGJhY2tlbmRGb2xsb3cpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5xdWV1ZVN0b3JlVXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhdHRyICYmIGF0dHIuZm9sbG93aW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgYS5jbGFzc0xpc3QuYWRkKFwic3Vic2NyaWJlZFwiKTtcclxuICAgICAgICAgICAgICBpZiAoaXNUYWcpIHtcclxuICAgICAgICAgICAgICAgIGEuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYXR0ci5jb2xvcjtcclxuICAgICAgICAgICAgICAgIGEuc3R5bGUuYm9yZGVyQ29sb3IgPSBhdHRyLmNvbG9yO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhLnN0eWxlLmNvbG9yID0gYXR0ci5jb2xvcjtcclxuICAgICAgICAgICAgICAgIGEuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBhLmNsYXNzTGlzdC5yZW1vdmUoXCJzdWJzY3JpYmVkXCIpO1xyXG4gICAgICAgICAgICAgIGEucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gYWRkaXRpb25hbCBzdHlsZXMgZm9yIGNhdGVnb3J5IHRhZ3NcclxuICAgICAgICAgICAgaWYgKGlzVGFnICYmIENBVEVHT1JZX1RBRy50ZXN0KG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgYS5zdHlsZS5vcGFjaXR5ID0gXCIwLjc1XCI7XHJcbiAgICAgICAgICAgICAgYS5zdHlsZS5ib3JkZXJTdHlsZSA9IFwiZGFzaGVkXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBzb3J0IHRhZ3MgaW50byBjYXRlZ29yaWVzXHJcbiAgICAgICAgaWYgKHJvd1R5cGUgPT09IFwiVGFnc1wiKSB7XHJcbiAgICAgICAgICBjb25zdCB0YWdMaXN0ID0gJChcIi50YWdzXCIsIHJvdykhO1xyXG4gICAgICAgICAgY29uc3QgZm9sbG93ZWQ6IFNvcnRhYmxlRWxzID0gW107XHJcbiAgICAgICAgICBjb25zdCBjb250ZW50OiBTb3J0YWJsZUVscyA9IFtdO1xyXG4gICAgICAgICAgY29uc3QgYmFjazogU29ydGFibGVFbHMgPSBbXTtcclxuICAgICAgICAgIGF0dHJzLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhID0gZWwgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gYS5ocmVmLm1hdGNoKEFUVFJJQlVURSk7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBcInRhZ3NcIjtcclxuICAgICAgICAgICAgICBjb25zdCBuYW1lID0gbWF0Y2hbMl07XHJcbiAgICAgICAgICAgICAgY29uc3QgaXNCYWNrID0gQ0FURUdPUllfVEFHLnRlc3QobmFtZSk7XHJcbiAgICAgICAgICAgICAgY29uc3QgYXR0ciA9IHRoaXMuZ2V0QXR0cih0eXBlLCBuYW1lKTtcclxuICAgICAgICAgICAgICBpZiAoaXNCYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBiYWNrLnB1c2goW25hbWUsIGFdKTtcclxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGF0dHIgJiYgYXR0ci5mb2xsb3dpbmcpIHtcclxuICAgICAgICAgICAgICAgIGZvbGxvd2VkLnB1c2goW25hbWUsIGFdKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKFtuYW1lLCBhXSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNsZWFuRWwodGFnTGlzdCk7XHJcbiAgICAgICAgICBmb2xsb3dlZC5zb3J0KHNvcnRFbHMpO1xyXG4gICAgICAgICAgY29udGVudC5zb3J0KHNvcnRFbHMpO1xyXG4gICAgICAgICAgYmFjay5zb3J0KHNvcnRFbHMpO1xyXG4gICAgICAgICAgZm9sbG93ZWRcclxuICAgICAgICAgICAgLmNvbmNhdChjb250ZW50KVxyXG4gICAgICAgICAgICAuY29uY2F0KGJhY2spXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKHRhZyA9PiB7XHJcbiAgICAgICAgICAgICAgdGFnTGlzdC5hcHBlbmRDaGlsZCh0YWdbMV0pO1xyXG4gICAgICAgICAgICAgIHRhZ0xpc3QuYXBwZW5kQ2hpbGQoZC5jcmVhdGVUZXh0Tm9kZShcIiBcIikpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUNBO0FBQ0E7Ozs7QUFFQTs7QUFBQTtBQUNBO0FBQ0E7QUFBQTs7QUFBQTtBQUNBO0FBQ0E7QUFBQTs7OztBQUVBOzs7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/attributes.ts\n");

/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _attributes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./attributes */ \"./src/attributes.ts\");\n/* harmony import */ var _reorder__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./reorder */ \"./src/reorder.ts\");\n\r\n\r\nvar attributes = new _attributes__WEBPACK_IMPORTED_MODULE_0__[\"AttributeStore\"]();\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n    attributes.init();\r\n    Object(_reorder__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\r\n});\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5kZXgudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2luZGV4LnRzP2M2YWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXR0cmlidXRlU3RvcmUgfSBmcm9tIFwiLi9hdHRyaWJ1dGVzXCI7XHJcbmltcG9ydCByZW9yZGVyQ29udGVudFBhZ2UgZnJvbSBcIi4vcmVvcmRlclwiO1xyXG5cclxuY29uc3QgYXR0cmlidXRlcyA9IG5ldyBBdHRyaWJ1dGVTdG9yZSgpO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgYXR0cmlidXRlcy5pbml0KCk7XHJcbiAgcmVvcmRlckNvbnRlbnRQYWdlKCk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/index.ts\n");

/***/ }),

/***/ "./src/reorder.ts":
/*!************************!*\
  !*** ./src/reorder.ts ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return reorderContentPage; });\nfunction reorderContentPage() {\r\n    var d = document;\r\n    var collection = d.querySelector(\"#content-collections\");\r\n    var chapters = d.querySelector(\"#chapters\");\r\n    var comments = d.querySelector(\"#comments\");\r\n    var content = collection || chapters;\r\n    if (content && comments) {\r\n        var parent_1 = comments.parentElement;\r\n        if (parent_1)\r\n            parent_1.insertBefore(content, comments);\r\n    }\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVvcmRlci50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvcmVvcmRlci50cz8wMGRmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlb3JkZXJDb250ZW50UGFnZSgpIHtcclxuICBjb25zdCBkID0gZG9jdW1lbnQ7XHJcblxyXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBkLnF1ZXJ5U2VsZWN0b3IoXCIjY29udGVudC1jb2xsZWN0aW9uc1wiKTtcclxuICBjb25zdCBjaGFwdGVycyA9IGQucXVlcnlTZWxlY3RvcihcIiNjaGFwdGVyc1wiKTtcclxuICBjb25zdCBjb21tZW50cyA9IGQucXVlcnlTZWxlY3RvcihcIiNjb21tZW50c1wiKTtcclxuICBjb25zdCBjb250ZW50ID0gY29sbGVjdGlvbiB8fCBjaGFwdGVycztcclxuICBpZiAoY29udGVudCAmJiBjb21tZW50cykge1xyXG4gICAgY29uc3QgcGFyZW50ID0gY29tbWVudHMucGFyZW50RWxlbWVudDtcclxuICAgIGlmIChwYXJlbnQpIHBhcmVudC5pbnNlcnRCZWZvcmUoY29udGVudCwgY29tbWVudHMpO1xyXG4gIH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/reorder.ts\n");

/***/ }),

/***/ "./src/util.ts":
/*!*********************!*\
  !*** ./src/util.ts ***!
  \*********************/
/*! exports provided: $, $$, cleanEl, log, debug */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"$\", function() { return $; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"$$\", function() { return $$; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cleanEl\", function() { return cleanEl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"log\", function() { return log; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"debug\", function() { return debug; });\nvar d = document;\r\nfunction $(selector, root) {\r\n    if (root === void 0) { root = d; }\r\n    return root.querySelector(selector);\r\n}\r\nfunction $$(selector, root) {\r\n    if (root === void 0) { root = d; }\r\n    return Array.prototype.slice.call(root.querySelectorAll(selector));\r\n}\r\nfunction cleanEl(el) {\r\n    while (el.firstChild) {\r\n        el.removeChild(el.firstChild);\r\n    }\r\n}\r\nfunction log() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    console.log.apply(null, args);\r\n}\r\nvar DEBUG = true;\r\nvar PREFIX = \"[FE]\";\r\nvar debug = {\r\n    log: function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (DEBUG) {\r\n            args.unshift(PREFIX);\r\n            console.log.apply(console, args);\r\n        }\r\n    },\r\n    error: function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (DEBUG) {\r\n            args.unshift(PREFIX);\r\n            console.error.apply(console, args);\r\n        }\r\n    },\r\n    trace: function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (DEBUG) {\r\n            args.unshift(PREFIX);\r\n            console.error.apply(console, args);\r\n        }\r\n    }\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdXRpbC50cz80OTU2Il0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGQgPSBkb2N1bWVudDtcclxuZXhwb3J0IGludGVyZmFjZSBRdWVyeWFibGUge1xyXG4gIHF1ZXJ5U2VsZWN0b3I6IHR5cGVvZiBkLnF1ZXJ5U2VsZWN0b3I7XHJcbiAgcXVlcnlTZWxlY3RvckFsbDogdHlwZW9mIGQucXVlcnlTZWxlY3RvckFsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uICQoc2VsZWN0b3I6IHN0cmluZywgcm9vdDogUXVlcnlhYmxlID0gZCkge1xyXG4gIHJldHVybiByb290LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gJCQoc2VsZWN0b3I6IHN0cmluZywgcm9vdDogUXVlcnlhYmxlID0gZCk6IEVsZW1lbnRbXSB7XHJcbiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHJvb3QucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5FbChlbDogRWxlbWVudCkge1xyXG4gIHdoaWxlIChlbC5maXJzdENoaWxkKSB7XHJcbiAgICBlbC5yZW1vdmVDaGlsZChlbC5maXJzdENoaWxkKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBsb2coLi4uYXJnczogYW55W10pIHtcclxuICBjb25zb2xlLmxvZy5hcHBseShudWxsLCBhcmdzKTtcclxufVxyXG5cclxuY29uc3QgREVCVUcgPSB0cnVlO1xyXG5jb25zdCBQUkVGSVggPSBcIltGRV1cIjtcclxuZXhwb3J0IGNvbnN0IGRlYnVnID0ge1xyXG4gIGxvZzogKC4uLmFyZ3M6IGFueVtdKSA9PiB7XHJcbiAgICBpZiAoREVCVUcpIHtcclxuICAgICAgYXJncy51bnNoaWZ0KFBSRUZJWCk7XHJcbiAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgZXJyb3I6ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xyXG4gICAgaWYgKERFQlVHKSB7XHJcbiAgICAgIGFyZ3MudW5zaGlmdChQUkVGSVgpO1xyXG4gICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgdHJhY2U6ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xyXG4gICAgaWYgKERFQlVHKSB7XHJcbiAgICAgIGFyZ3MudW5zaGlmdChQUkVGSVgpO1xyXG4gICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIE1heWJlPFQ+ID0gVCB8IHVuZGVmaW5lZDtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1BO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util.ts\n");

/***/ })

/******/ });